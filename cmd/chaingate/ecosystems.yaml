ecosystems:
  - id: "npm"
    hosts:
      - "registry.npmjs.org"
      - "*.npmjs.org"
      - "registry.yarnpkg.com"
      - "*.yarnpkg.com"
    patterns:
      # Metadata / index retrieval
      - name: "npm-metadata"
        path_regex: "^/(?P<package>[^/]+)/?$"
        # Version unknown - skip check or handle separately
      # Tarball download
      - name: "npm-tarball"
        path_regex: "^/(?P<package>[^/]+)/-/(?P<file>[^/]+)\\.tgz$"
        extract:
          version_from_file_regex: "^[^-]+-(?P<version>.+)$"
      # Scoped package tarball
      - name: "npm-scoped-tarball"
        path_regex: "^/(?P<scope>@[^/]+)%2[Ff](?P<name>[^/]+)/-/(?P<file>[^/]+)\\.tgz$"
        extract:
          version_from_file_regex: "^[^-]+-(?P<version>.+)$"

  - id: "RubyGems"
    hosts:
      - "rubygems.org"
      - "*.rubygems.org"
    patterns:
      # Gem file download: /downloads/rails-7.1.0.gem
      - name: "rubygems-gem"
        path_regex: "^/downloads/(?P<file>[^/]+)\\.gem$"
        extract:
          # rails-7.1.0 → name=rails, version=7.1.0
          name_version_from_file_regex: "^(?P<name>.+)-(?P<version>[0-9][^-]+)$"
      # API calls (version unknown)
      - name: "rubygems-api"
        path_regex: "^/api/v1/gems/(?P<name>[^/]+)\\.json$"

  - id: "PyPI"
    hosts:
      - "files.pythonhosted.org"
      - "*.pythonhosted.org"
    patterns:
      # Wheel download: /packages/xx/xx/hash/package-1.0.0-py3-none-any.whl
      - name: "pypi-wheel"
        path_regex: "^/packages/[0-9a-f]{2}/[0-9a-f]{2}/[0-9a-f]+/(?P<file>.+)\\.whl$"
        extract:
          # requests-2.31.0-py3-none-any → name=requests, version=2.31.0
          name_version_from_file_regex: "^(?P<name>.+?)-(?P<version>[0-9][^-]*(-[^-]+)*)-[^-]+-[^-]+-[^-]+$"
      # Source distribution (tar.gz): /packages/xx/xx/hash/package-1.0.0.tar.gz
      - name: "pypi-sdist-targz"
        path_regex: "^/packages/[0-9a-f]{2}/[0-9a-f]{2}/[0-9a-f]+/(?P<file>.+)\\.tar\\.gz$"
        extract:
          # requests-2.31.0 → name=requests, version=2.31.0
          name_version_from_file_regex: "^(?P<name>.+)-(?P<version>[0-9].*)$"
      # Source distribution (zip): /packages/xx/xx/hash/package-1.0.0.zip
      - name: "pypi-sdist-zip"
        path_regex: "^/packages/[0-9a-f]{2}/[0-9a-f]{2}/[0-9a-f]+/(?P<file>.+)\\.zip$"
        extract:
          # requests-2.31.0 → name=requests, version=2.31.0
          name_version_from_file_regex: "^(?P<name>.+)-(?P<version>[0-9].*)$"
